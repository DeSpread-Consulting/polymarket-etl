# Agent Guidelines (작업 지침서)

이 문서는 이 프로젝트에서 작업하는 모든 AI 에이전트가 반드시 준수해야 할 행동 수칙입니다.

## 1. 언어 및 소통 (Language & Communication)
*   **한국어 필수**: 에이전트는 사용자와의 대화, 작업 태스크 설명, 기타 안내 문서 작성 시 항상 **한국어**를 사용해야 합니다.
*   **명확한 안내**: 기술적인 내용이라도 사용자가 이해하기 쉽게 설명하며, 필요한 경우 번역이나 풀이를 제공합니다.

## 2. README.md 업데이트 (Documentation Maintenance)
*   **최신 상태 유지**: `README.md`는 프로젝트를 처음 접하는 사람이나 내부 개발팀이 시스템의 동작 방식을 이해할 수 있도록 항상 최신 상태여야 합니다.
*   **업데이트 기준**:
    *   단순 버그 수정이나 사소한 변경은 반영하지 않아도 됩니다.
    *   **작동 방식의 변경**, **새로운 기능 추가**, **주요 아키텍처 변화**(예: DB 제약조건 추가, 폴더 구조 변경) 발생 시 반드시 업데이트합니다.
    *   코드를 보지 않고도 `README.md`만으로 사용법과 고려사항을 파악할 수 있어야 합니다.

## 3. SYSTEM_OVERVIEW.md 관리 (Context Preservation)
*   **컨텍스트 보존**: 에이전트의 프롬프트가 초기화되더라도 이 파일만 읽으면 프로젝트의 전반적인 상태를 파악할 수 있어야 합니다.
*   **포함 내용**:
    *   전체 동작 방식 (Architecture)
    *   사용자의 과거 요구사항 및 의도 (User Intent)
    *   최근 수정 내역과 그 이유 (Rationale)
    *   시행착오 및 해결 과정 (Lessons Learned)
*   **작성 원칙**: 내용은 복잡하거나 기술적이어도 무방하며, 에이전트가 이해하고 활용할 수 있는 수준으로 상세히 기록합니다.
*   **자동 업데이트 시점** (필수):
    *   **주요 버그 수정 완료 시**: 섹션 5 "최근 수정 내역"에 문제/원인/해결/결과 기록
    *   **새로운 기능 구현 시**: 섹션 4 "주요 기능 구현"에 추가 + 섹션 5에 구현 과정 기록
    *   **아키텍처 변경 시**: 섹션 2 "아키텍처" 업데이트 + 섹션 5에 변경 이유 기록
    *   **데이터베이스 스키마 변경 시**: 섹션 3 "데이터베이스 스키마" 업데이트
    *   **새로운 제약사항 발견 시**: 섹션 6 "알려진 제약사항" 추가

## 4. 파일 관리 및 정리 (File Management)
*   **임시 파일 삭제 원칙**: 테스트나 디버깅 목적으로 생성된 파일은 작업 완료 후 **삭제**하는 것을 원칙으로 합니다.
*   **예외**: 향후에도 지속적인 디버깅이나 유지보수에 필수적이라고 판단되는 파일(예: 백필 코드, 헬스 체크 스크립트)은 남겨두되, 적절한 폴더(예: `src/debugging`)로 정리합니다.

## 5. 능동적 제안 (Proactive Engagement)
*   **올바른 방향 제시**: 사용자의 요청을 수행하되, 만약 그 요청이 프로젝트의 건전성을 해치거나 더 나은 방법이 있다고 판단될 경우 즉시 사용자에게 질문하거나 대안을 제안합니다.
*   **맹목적 수행 지양**: 사용자가 놓친 부분이나 잠재적 위험 요소가 있다면 반드시 짚고 넘어갑니다.

## 6. 보안 우선 원칙 (Security First)
*   **민감 정보 보호**: `.env` 파일, 개인키(`ORACLE_PRIVATE_KEY`), API Key 등 민감한 정보는 절대 코드에 하드코딩하거나 아티팩트(Artifact)에 노출하지 않습니다.
*   **환경 변수 사용**: 모든 비밀 값은 환경 변수를 통해서만 접근하도록 코드를 작성합니다.

## 7. 검증 후 실행 (Verify Before Exec)
*   **사전 검증**: 사용자가 실행해야 할 명령어(특히 SQL, 대량 삭제, 마이그레이션)를 제안하기 전에, 에이전트는 가능한 한 먼저 테스트 코드(예: `verify_constraints.js`)를 작성하고 실행하여 안전성을 검증해야 합니다.
*   **결과 기반 제안**: "될 것 같습니다"가 아니라 "테스트 결과 성공했으니 실행하십시오"라고 명확한 근거를 제시합니다.

## 8. 지침 추가 요청 (Evolution)
*   이 가이드라인에 포함되지 않았으나 프로젝트 진행에 도움이 될 만한 수칙이 있다면, 에이전트는 사용자에게 그 필요성을 설명하고 추가를 요청합니다.

## 9. 온도 시장 및 그룹 이벤트 처리 (Temperature Markets & Event Groups)
*   **URL 정규화**: 온도 예측 시장과 같이 여러 옵션이 하나의 이벤트 그룹으로 관리되는 경우, slug를 자동으로 정규화하여 올바른 그룹 페이지로 이동하도록 처리합니다.
*   **패턴 인식**: 날짜-온도값-단위 패턴 (예: `2026-41forbelow`, `2026-0c`)을 감지하고 온도 부분을 제거하여 기본 이벤트 slug만 사용합니다.
*   **적용 범위**: Fahrenheit와 Celsius 모두 지원하며, 단일 온도, 범위, 이상/이하 패턴을 모두 처리합니다.

---

## 프로젝트별 특이사항

### 웹 애플리케이션 (web/)
- **KST 타임존**: 모든 날짜/시간은 한국 표준시(KST) 기준으로 표시됩니다.
- **Polymarket 연동**: 시장 데이터는 Supabase의 `poly_events` 테이블에서 가져오며, 30일 이내 이벤트만 표시합니다.
- **필터링 기본값**: 거래량 $10K 이상, 스포츠 카테고리 제외가 기본 설정입니다.

### 데이터베이스
- **테이블**: `poly_events` - Polymarket 시장 데이터 저장
- **주요 필드**: `id`, `title`, `slug`, `end_date`, `volume`, `probs`, `category`, `closed`
- **정산 처리**: `closed` 필드로 정산 완료 여부 관리

---

*Last Updated: 2026-02-10*
