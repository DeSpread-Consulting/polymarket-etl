<!DOCTYPE html>
<html lang="ko" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="/admin/">
    <title>Polymarket Admin</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="admin.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../config.js"></script>
</head>
<body>
    <!-- Login Gate -->
    <div id="loginGate" class="admin-login-gate">
        <div class="admin-login-card">
            <h2>Polymarket Admin</h2>
            <p class="login-subtitle">관리자 로그인</p>
            <form id="loginForm">
                <input type="email" id="adminEmail" placeholder="이메일" required>
                <input type="password" id="adminPassword" placeholder="비밀번호" required>
                <button type="submit" class="btn-primary">Sign In</button>
                <div id="loginError" class="error-message"></div>
            </form>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" style="display:none;">
        <!-- Header -->
        <div class="admin-header">
            <div class="admin-header-left">
                <h1>Polymarket Admin</h1>
            </div>
            <div class="admin-header-right">
                <a href="../index.html" class="btn-secondary">캘린더 보기</a>
                <button id="signOutBtn" class="btn-secondary">로그아웃</button>
            </div>
        </div>

        <!-- Stats -->
        <div class="admin-stats" id="adminStats">
            <div class="stat-card">
                <div class="stat-value" id="statTotal">-</div>
                <div class="stat-label">전체 시장</div>
            </div>
            <div class="stat-card stat-green">
                <div class="stat-value" id="statTranslated">-</div>
                <div class="stat-label">번역 완료</div>
            </div>
            <div class="stat-card stat-yellow">
                <div class="stat-value" id="statUntranslated">-</div>
                <div class="stat-label">미번역</div>
            </div>
            <div class="stat-card stat-red">
                <div class="stat-value" id="statHidden">-</div>
                <div class="stat-label">숨김</div>
            </div>
        </div>

        <!-- Toolbar -->
        <div class="admin-toolbar">
            <input type="text" id="adminSearch" placeholder="시장 검색..." class="admin-search">
        </div>

        <!-- Filter Chips -->
        <div class="admin-filter-section">
            <!-- Category Chips -->
            <div class="admin-filter-group">
                <span class="admin-filter-label">카테고리</span>
                <div class="admin-filter-chips" id="categoryChips">
                    <!-- JS에서 생성 -->
                </div>
            </div>

            <!-- Status Chips -->
            <div class="admin-filter-group">
                <span class="admin-filter-label">상태</span>
                <div class="admin-filter-chips" id="statusChips">
                    <button class="admin-chip active" data-filter="translation" data-value="">전체</button>
                    <button class="admin-chip" data-filter="translation" data-value="translated">번역 완료</button>
                    <button class="admin-chip" data-filter="translation" data-value="untranslated">미번역</button>
                </div>
                <div class="admin-filter-chips" id="hiddenChips" style="margin-left: 12px;">
                    <button class="admin-chip active" data-filter="hidden" data-value="">전체</button>
                    <button class="admin-chip" data-filter="hidden" data-value="visible">노출 중</button>
                    <button class="admin-chip" data-filter="hidden" data-value="hidden">숨김</button>
                </div>
            </div>

            <!-- Sort Chips -->
            <div class="admin-filter-group">
                <span class="admin-filter-label">정렬</span>
                <div class="admin-filter-chips" id="sortChips">
                    <button class="admin-chip active" data-filter="sort" data-value="volume">거래량순</button>
                    <button class="admin-chip" data-filter="sort" data-value="end_date">마감일순</button>
                    <button class="admin-chip" data-filter="sort" data-value="title">이름순</button>
                </div>
            </div>
        </div>

        <!-- Table -->
        <div class="admin-table-wrap">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th class="col-toggle">노출</th>
                        <th class="col-title">Title (EN)</th>
                        <th class="col-title-ko">Title (KO)</th>
                        <th class="col-category">Category</th>
                        <th class="col-volume">Volume</th>
                        <th class="col-date">End Date</th>
                        <th class="col-actions">편집</th>
                    </tr>
                </thead>
                <tbody id="marketTableBody"></tbody>
            </table>
        </div>

        <!-- Pagination -->
        <div class="admin-pagination" id="pagination"></div>

        <!-- Loading -->
        <div id="loadingIndicator" class="loading-indicator" style="display:none;">
            데이터 로딩 중...
        </div>
    </div>

    <!-- Edit Modal -->
    <div class="modal-overlay" id="editModalOverlay">
        <div class="admin-modal">
            <div class="modal-header">
                <h3>시장 편집</h3>
                <button class="modal-close" id="editModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="edit-field">
                    <label>Title (EN) <a id="editPolyLink" href="#" target="_blank" style="display:none;float:right;font-size:0.75rem;font-weight:400;color:var(--accent-blue);text-decoration:none;">Polymarket에서 보기 &rarr;</a></label>
                    <div class="readonly-field" id="editTitleEn"></div>
                </div>
                <div class="edit-field">
                    <label>Title (KO)</label>
                    <textarea id="editTitleKo" rows="2" placeholder="한국어 번역을 입력하세요"></textarea>
                </div>
                <div class="edit-field">
                    <label>Category</label>
                    <select id="editCategory">
                        <option value="Sports">Sports</option>
                        <option value="Crypto">Crypto</option>
                        <option value="Politics">Politics</option>
                        <option value="Finance">Finance</option>
                        <option value="Pop Culture">Pop Culture</option>
                        <option value="Science">Science</option>
                        <option value="Business">Business</option>
                        <option value="Technology">Technology</option>
                        <option value="Gaming">Gaming</option>
                        <option value="Music">Music</option>
                        <option value="Uncategorized">Uncategorized</option>
                    </select>
                </div>
                <div class="edit-field">
                    <label>Description (Rules)</label>
                    <div class="readonly-field description-field" id="editDescription">-</div>
                </div>
                <div class="edit-field">
                    <label>Description (KO)</label>
                    <textarea id="editDescriptionKo" rows="5" placeholder="한국어 규칙 설명을 입력하세요"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="editCancel">취소</button>
                <button class="btn-primary" id="editSave">저장</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="admin-toast"></div>

    <script src="../admin-auth.js"></script>
    <script src="admin.js"></script>
</body>
</html>
